#!/bin/bash
# MySync monthly script
# Last updated: February 27th, 2016
# See readme.txt for details
#
###############################################################################################
################ DO NOT EDIT BELOW THIS LINE UNLESS YOU KNOW WHAT YOU'RE DOING ################
###############################################################################################

if [[ "$@" == "" ]]
    then
	echo "something bad happened... no arguments passed... exiting."
	exit
fi

unset PATH
RM=/bin/rm
MV=/bin/mv
CP=/bin/cp
TOUCH=/usr/bin/touch
RSYNC=/usr/bin/rsync
LOCATION=$1
EXCLUDES=backup_exclude.txt
DEBUG="$3"

########################## monthly backups ###################################
# Delete the oldest snapshot, if it exists, move others recursively
if [ -d $LOCATION/monthly/monthly.6 ]
   then
	$RM -rf $LOCATION/monthly/monthly.6
fi
if [ -d $LOCATION/monthly/monthly.5 ]
    then
        $MV $LOCATION/monthly/monthly.5 $LOCATION/monthly/monthly.6
fi
if [ -d $LOCATION/monthly/monthly.4 ]
    then
        $MV $LOCATION/monthly/monthly.4 $LOCATION/monthly/monthly.5
fi
if [ -d $LOCATION/monthly/monthly.3 ]
    then
        $MV $LOCATION/monthly/monthly.3 $LOCATION/monthly/monthly.4
fi
if [ -d $LOCATION/monthly/monthly.2 ]
    then
	$MV $LOCATION/monthly/monthly.2 $LOCATION/monthly/monthly.3
fi
if [ -d $LOCATION/monthly/monthly.1 ]
    then
	$MV $LOCATION/monthly/monthly.1 $LOCATION/monthly/monthly.2
fi
if [ -d $LOCATION/monthly/monthly.0 ]
    then
	$MV $LOCATION/monthly/monthly.0 $LOCATION/monthly/monthly.1
fi


echo "Monthly log rotation completed!" | logger -s >> mysync.log


